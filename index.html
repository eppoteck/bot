<!doctype html>
<html lang="id">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Chatbot Informasi</title>
  <style>
    body{font-family:Segoe UI, Roboto, Arial; background:#f2f6fb; margin:0; display:flex; align-items:center; justify-content:center; height:100vh}
    .chat {width:420px; max-width:95%; background:#fff; border-radius:8px; box-shadow:0 8px 24px rgba(11,22,40,.08); overflow:hidden; display:flex; flex-direction:column}
    .header{padding:12px 16px; background:#0b63d6; color:#fff}
    .messages{padding:16px; height:360px; overflow:auto; display:flex; flex-direction:column; gap:10px; background:linear-gradient(#fff,#f9fbff)}
    .msg{max-width:85%; padding:10px 12px; border-radius:12px; line-height:1.3}
    .user{align-self:flex-end; background:#e6f0ff; color:#032b57}
    .bot{align-self:flex-start; background:#f1f4f8; color:#07203b}
    .footer{display:flex; gap:8px; padding:10px; border-top:1px solid #eef2f6}
    input[type="text"]{flex:1; padding:10px 12px; border:1px solid #d7dde6; border-radius:8px}
    button{background:#0b63d6;color:#fff;border:none;padding:10px 12px;border-radius:8px;cursor:pointer}
    a.link {color:#0b63d6; text-decoration:none; font-weight:600}
  </style>
</head>
<body>
  <div class="chat" role="region" aria-label="Chatbot informasi">
    <div class="header">Bot Info Administrasi</div>
    <div id="messages" class="messages" aria-live="polite"></div>
    <form id="form" class="footer" onsubmit="return false;">
      <input id="input" type="text" placeholder="Tanya: syarat KTP, cara buat SIM, info BPJS..." autocomplete="off" />
      <button id="send">Kirim</button>
    </form>
  </div>

  <script>
    // Pengetahuan sederhana / link resmi
    const kb = {
      ktp: {
        title: 'Membuat KTP (Kartu Tanda Penduduk)',
        text: 'Syarat umum: membawa Kartu Keluarga (KK), akta kelahiran/ surat keterangan lahir, fotokopi. Proses: registrasi di Dinas Dukcapil kab/kota, verifikasi data, pengambilan foto. Untuk e-KTP, cek persyaratan di website Dukcapil.',
        link: {url:'https://www.dukcapil.kemendagri.go.id/', label:'Info Dukcapil'}
      },
      kk: {
        title: 'Membuat / Mengurus KK (Kartu Keluarga)',
        text: 'Perubahan atau penerbitan KK biasanya memerlukan dokumen identitas anggota keluarga (KTP, akta), laporan kelahiran/kematian/perubahan alamat ke Dukcapil setempat.',
        link: {url:'https://www.dukcapil.kemendagri.go.id/', label:'Info Dukcapil'}
      },
      sim: {
        title: 'Membuat SIM (Surat Izin Mengemudi)',
        text: 'Persyaratan umum: fotokopi KTP, foto, lulus tes kesehatan dan psikologi (tergantung jenis SIM), lulus ujian teori dan praktik di Satpas/Polres setempat.',
        link: {url:'https://sim.korlantas.polri.go.id/', label:'Info SIM Korlantas'}
      },
      bpjs: {
        title: 'BPJS Kesehatan',
        text: 'Pendaftaran bisa dilakukan online atau ke kantor BPJS. Persyaratan: KTP, KK, dan data kontak. Pilih kelas dan metode pembayaran.',
        link: {url:'https://www.bpjs-kesehatan.go.id/', label:'Info BPJS Kesehatan'}
      }
    };

    const messagesEl = document.getElementById('messages');
    const inputEl = document.getElementById('input');
    const sendBtn = document.getElementById('send');

    function appendMessage(text, who='bot') {
      const div = document.createElement('div');
      div.className = 'msg ' + (who==='user' ? 'user' : 'bot');
      div.innerHTML = text;
      messagesEl.appendChild(div);
      messagesEl.scrollTop = messagesEl.scrollHeight;
    }

    // small-talk / persona replies
    const persona = {
      greetings: [
        'Halo! Saya asisten informasi administrasi. Bisa bantu tentang KTP, KK, SIM, atau BPJS.',
        'Hai! Saya bot informasi. Apa yang ingin Anda tanyakan hari ini?',
        'Halo â€” saya asisten virtual. Silakan tanya kebutuhan administrasi Anda.'
      ],
      thanks: [
        'Sama-sama. Butuh bantuan lain?',
        'Dengan senang hati. Ada yang lain?'
      ],
      bye: [
        'Sampai jumpa. Semoga membantu.',
        'Baik, jika perlu kembali kapan saja.'
      ],
      fallback: [
        'Maaf, saya belum paham. Coba tanyakan: "cara buat KTP" atau "syarat SIM".',
        'Saya belum bisa menjawab itu. Anda bisa minta "menu" untuk opsi.'
      ]
    };

    function rand(arr){ return arr[Math.floor(Math.random()*arr.length)]; }

    function botReply(raw) {
      const msg = raw.toLowerCase();

      // greetings and small talk
      if (/\b(hi|halo|hai|selamat pagi|selamat siang|selamat sore|selamat malam)\b/.test(msg)) {
        return rand(persona.greetings);
      }
      if (/\b(terima kasih|thanks|makasih|trimakasih)\b/.test(msg)) {
        return rand(persona.thanks);
      }
      if (/\b(bai|bye|sampai jumpa|dadah|selamat tinggal)\b/.test(msg)) {
        return rand(persona.bye);
      }
      if (/\b(kenalan|siapa kamu|kamu siapa|apa kamu)\b/.test(msg)) {
        return 'Saya asisten virtual yang membantu informasi pembuatan KTP, KK, SIM, dan BPJS. Sebutkan yang Anda butuhkan.';
      }

      // keyword matching for services
      if (/\b(ktp|e-?ktp)\b/.test(msg)) return formatKB(kb.ktp);
      if (/\b(kk|kartu keluarga)\b/.test(msg)) return formatKB(kb.kk);
      if (/\b(sim|surat izin mengemudi)\b/.test(msg)) return formatKB(kb.sim);
      if (/\b(bpjs|bpjs kesehatan|bpjs-kesehatan)\b/.test(msg)) return formatKB(kb.bpjs);

      // if user asks about syarat/cara/biaya
      if (/\b(syarat|cara|biaya|langkah)\b/.test(msg)) {
        if (/ktp/.test(msg)) return formatKB(kb.ktp);
        if (/kk/.test(msg)) return formatKB(kb.kk);
        if (/sim/.test(msg)) return formatKB(kb.sim);
        if (/bpjs/.test(msg)) return formatKB(kb.bpjs);
        return 'Sebutkan tujuan: KTP, KK, SIM, atau BPJS. Contoh: "cara buat SIM".';
      }

      if (/\b(help|menu|opsi|pilihan)\b/.test(msg)) {
        return 'Anda bisa tanya: "cara buat KTP", "syarat KK", "informasi SIM", atau "daftar BPJS".';
      }

      return rand(persona.fallback);
    }

    function formatKB(item){
      return '<strong>' + item.title + '</strong><br>' + item.text + '<br><a class="link" href="' + item.link.url + '" target="_blank" rel="noopener">' + item.link.label + '</a>';
    }

    // initial welcome (AI-like)
    appendMessage(rand(persona.greetings));

    // send handler
    function send() {
      const text = inputEl.value.trim();
      if (!text) return;
      appendMessage(escapeHtml(text), 'user');
      inputEl.value = '';
      // simulate typing delay
      appendMessage('...', 'bot');
      setTimeout(() => {
        // remove typing
        const last = messagesEl.querySelectorAll('.bot');
        if (last.length) {
          const loader = last[last.length-1];
          if (loader && loader.textContent === '...') loader.remove();
        }
        const reply = botReply(text);
        appendMessage(reply, 'bot');
      }, 600);
    }

    sendBtn.addEventListener('click', send);
    inputEl.addEventListener('keydown', e => { if (e.key === 'Enter') send(); });

    // simple HTML escape
    function escapeHtml(s){ return s.replace(/&/g,'&amp;').replace(/</g,'&lt;').replace(/>/g,'&gt;'); }
  </script>
</body>
</html>